<?php
/* 
Требуются: 
	$list - список задач
*/
?><table id="issuesList" class="issues-list">
	<thead>
		<tr>
			<th>#</th>
			<th>Тип</th>
			<th>Название</th>
			<th>Исполнители</th>
			<th>Описание</th>
			<th>Дата окончания</th>
			<th>Управление</th>
		</tr>
	</thead>
	<tbody>
		<? foreach ($list as $issue) {?>
		<tr class="<?switch($issue->status): 
    	case 0: ?>active-issue<?break;?> 
    	<?case 1: ?>verify-issue<?break;?> 
    	<?case 2: ?>completed-issue<?break;?>
    	<?endswitch;?>">			
			<td><a href="<?=$issue->getURL4View();?>"><?=$issue->getIdInProject();?></a>
             <div class="issue_copy popup-menu">
             	   	<a href="javascript:;" class="issue-commit-copy-link">скопировать commit сообщение</a>
             </div>
			</td>
			<td>
			 <nobr>
			     <span class="priority-val circle" title="Приоритет: <?=$issue->getPriorityStr();?>">
			     <?=$issue->priority;?></span><?=$issue->getType();?>
			 </nobr>			 
			</td>
			<td>
			<a href="<?=$issue->getURL4View();?>">
			 	<span class="issue-name"><?=$issue->getName();?></span>
			 	<?php if ($issue->getNormHours() > 0): ?> (<span class="issue-hours"><?=$issue->getNormHours();?></span> <?=$issue->getNormHoursLabel(true);?>)<?php endif;?>
    		</a>
			 <?if ($issue->commentsCount > 0):?>
                 &nbsp;<span class="comments-count" title="комментариев"><?=$issue->commentsCount;?></span>
                 <?endif;?>
			</td>
			<td class="member-list">
			   <?foreach ($issue->getMembers() as $i => $member):?>
			   <?=$i>0?', ':''?><a href="javascript:;" data-member-id="<?=$member->getID();?>"><?=$member->getLinkedName();?></a>
			   <?endforeach;?>
			</td>
			<td><p class="issue-list-item-desc"><?=$issue->getShortDesc();?></p></td>
			<td><?=($issue->isCompleted()?$issue->getCompletedDate():$issue->getCompleteDate());?></td>
			<td> 	
				<input type="hidden" name="issueId" value="<?=$issue->id;?>"/>
				<button onclick="restoreIssue( event );" class="restore-btn">Открыть</button>
				<button onclick="completeIssue( event );" class="complete-btn">Завершить</button>
			</td>
		</tr>			
		<? }?>
	</tbody>
</table>